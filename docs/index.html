<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
</head>
<body class="layout-container">

<header>
  <a href="./">Home</a>
  <a href="identifiers.html">Identifier</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/TechnologyAdvice/gateway-lambda" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav">





<div data-ice="variableWrap">
  <h2><a href="variable/">Variable</a></h2>
  <ul>
    
  <li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-buildConfig">buildConfig</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-config">config</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-init">init</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-initRoutes">initRoutes</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-loadSchema">loadSchema</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-log">log</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-mapTemplateParams">mapTemplateParams</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-parseBody">parseBody</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-procResponse">procResponse</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-routes">routes</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-runLambda">runLambda</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-schema">schema</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-service">service</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-setRunner">setRunner</a></span></li>
<li data-ice="variableDoc"><span><a href="variable/index.html#static-variable-walkSchema">walkSchema</a></span></li>
</ul>
</div>




</nav>

<div class="content" data-ice="content"><div data-ice="index"><h1 id="glambda">GLambda</h1>
<h3 id="aws-gateway-lambda-testing-module">AWS Gateway + Lambda Testing Module</h3>
<p>A module for mocking and testing AWS <a href="http://aws.amazon.com/api-gateway/">API Gateway</a>
in conjunction with <a href="http://aws.amazon.com/lambda/">Lambda</a> functions.</p>
<h2 id="introduction">Introduction</h2>
<h2 id="setup">Setup</h2>
<p>To see a fully functional demo, see the <a href="/test"><code>/test</code></a> directory. The <code>index.js</code>
file is setup to run using the <a href="/test/lambdas"><code>lambdas</code></a> and the <a href="/test/gateway.yml"><code>gateway.yml</code></a>
file. The tests run against this configuration as well.</p>
<p>After installing the npm module simply include it in a file where it will run and
set any config options on <code>init</code>:</p>
<pre><code class="lang-javascript"><pre class="source-code"><code class="prettyprint">// Include the module
var glmock = require(&apos;glambda&apos;)
// Set options and init
glmock.init({
  lambdas: &apos;./lambdas&apos;,
  schema: &apos;./gateway.yml&apos;,
  port: 8181,
  apiPath: &apos;/api&apos;,
  log: true
})</code></pre>
</code></pre>
<p>The above shows a standard set of config options:</p>
<ul>
<li><code>lambdas</code>: Path to the directory containing lambdas</li>
<li><code>schema</code>: Path to the API gateway YAML config</li>
<li><code>port</code>: Port on which the HTTP server will run</li>
<li><code>apiPath</code>: Any path (proceeding root) to include in HTTP requests mapping</li>
<li><code>log</code>: Wether or not to log to console</li>
</ul>
<p>Simply running the file created above will spin up the service, then accessing
the endpoints via the corresponding lambda name will spawn the Lambda function
and return its results.</p>
<h2 id="the-gateway-yaml-configuration">The Gateway YAML Configuration</h2>
<p>The <a href="/test/gateway.yml"><code>gateway.yml</code></a> format was designed to closely match the
AWS <a href="http://aws.amazon.com/api-gateway/">API Gateway</a>. The structure is intended
to appear similar to the Resource (left-hand) pane when editing an API in the
web interface.</p>
<pre><code class="lang-YAML"><pre class="source-code"><code class="prettyprint">---
  /:
    /foo:
      GET:
          lambda: &quot;foo&quot;
          templates:
            application/json:
              method: &quot;get&quot;
      POST:
          lambda: &quot;foo&quot;
          templates:
            application/json:
              method: &quot;post&quot;
              body: &quot;$input.json(&apos;$&apos;)&quot;
      /foo/{fooId}:
        GET:
          lambda: &quot;foo&quot;
          templates:
            application/json:
              id: &quot;$input.params(&apos;fooId&apos;)&quot;
              method: &quot;get&quot;
        PUT:
          lambda: &quot;foo&quot;
          templates:
            application/json:
              id: &quot;$input.params(&apos;fooId&apos;)&quot;
              baz: &quot;quz&quot;
              body: &quot;$input.json(&apos;$&apos;)&quot;</code></pre>
</code></pre>
<p>It&apos;s simple to identify the core nodes of the tree, i.e. the paths of the requests
and their associated methods. To explain, the following shows results of a number
of requests made against the above configuration:</p>
<table>
<thead>
<tr>
<th>PATH</th>
<th>METHOD</th>
<th>BODY</th>
<th>RESPONSE/EVENT</th>
</tr>
</thead>
<tbody>
<tr>
<td>/</td>
<td>ANY</td>
<td>N/A</td>
<td><code>METHOD NOT ALLOWED</code></td>
</tr>
<tr>
<td>/foo</td>
<td>GET</td>
<td>N/A</td>
<td><code>{ method: &apos;get&apos; }</code></td>
</tr>
<tr>
<td>/foo</td>
<td>POST</td>
<td><code>{ fizz: &apos;buzz&apos; }</code></td>
<td><code>{ method: &apos;post&apos;, body: { fizz: &apos;buzz&apos; }</code></td>
</tr>
<tr>
<td>/foo/123</td>
<td>GET</td>
<td>N/A</td>
<td><code>{ method: &apos;get&apos;, fooId: 123 }</code></td>
</tr>
<tr>
<td>/foo/123</td>
<td>PUT</td>
<td><code>{ baz: &apos;quz&apos; }</code></td>
<td><code>{ method: &apos;put&apos;, fooId: 123, body: { baz: &apos;quz&apos; } }</code></td>
</tr>
</tbody>
</table>
<h2 id="makefile-and-scripts">Makefile and Scripts</h2>
<p>A <code>Makefile</code> is included for managing build and install tasks. The commands are
then referenced in the <code>package.json</code> <code>scripts</code> if that is the preferred
task method:</p>
<ul>
<li><code>all</code> (default) will run all build tasks</li>
<li><code>start</code> will run the main script</li>
<li><code>clean</code> will remove the <code>/build</code> and <code>/node_modules</code> directories</li>
<li><code>build</code> will transpile ES2015 code in <code>/src</code> to <code>/build</code></li>
<li><code>test</code> will run all spec files in <code>/test/src</code></li>
<li><code>lint</code> will lint all files in <code>/src</code></li>
<li><code>doc</code> will run ESDoc on all files in <code>/src</code> and output to <code>/docs</code></li>
<li><code>report</code> will run Plato static analysis on <code>/build</code> and output to <code>/report</code></li>
<li><code>dev</code> will run...<ul>
<li>linting, then...</li>
<li>tests, then...</li>
<li>build/transpile, then...</li>
<li>the main script.</li>
</ul>
</li>
<li><code>watch</code> will run the <code>dev</code> task and rerun on change of <code>/src</code> files</li>
</ul>
<p>Both <code>make {COMMAND}</code> and <code>npm run {COMMAND}</code> work for any of the above commands.</p>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.1.4)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
